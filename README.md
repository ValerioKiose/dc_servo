
# Μετατροπή κινητήρα συνεχούς ρεύματος σε σερβοκινητήρα χρησιμοποιώντας το μικροελεγκτή ATmega328 και έναν κωδικοποιητή θέσης.

Το πρόγραμμα γράφτηκε για να εξετάσουμε αν θα ήταν βιώσιμη η αντικατάσταση βηματικών κινητήρων, με απλούς κινητήρες συνεχούς ρεύματος σε διαμόρφωση κλειστού βρόχου, με μόνο στόχο τηn μείωση του κόστους διάφορων χόμπι έργων που απαιτούν ακριβή έλεγχο κινήσεων.



## Λειτουργιά προγράμματος

Το πρόγραμμα δέχεται εντολές βημάτων και κατεύθυνσης βημάτων από ξεχωριστό ελεγκτή, στην περίπτωση μας ένα Arduino UNO το οποίο τρέχει το ανοικτό λογισμικό GRBL. Μέσω ενός BTS7960 το πρόγραμμα οδηγεί τον κινητήρα συνεχούς ρεύματος και με την χρήση του κωδικοποιητή θέσης ενημερώνετε κάθε 1 κύκλο εκτέλεσης η θέση του κινητήρα. Ο κινητήρας οδηγείτε στην ανάλογη κατεύθυνση μέχρι να διανύσει τα βήματα που λάβαμε από τον ελεγκτή.

Με την ενημέρωση της θέσης του κινητήρα κάθε 1 κύκλο εκτέλεσης, επιταχύνουμε έναν κλειστό βρόχο, χρησιμοποιούμε δηλαδή το αποτέλεσμα της κίνησης που έκανε ο κινητήρας, για να προσδιορίσουμε αν το βήμα που κάναμε ήταν προς την σωστή κατεύθυνση ή όχι, αν έχει γίνει λάθος αυτό διορθώνετε με αντίθετη κίνηση. Παράδειγμα, αν θέλουμε 15 βήματα αριστερά, και ο κινητήρας τελικά διανύσει 17 βήματα αριστερά, αυτόματα θα κάνει 2 βήματα δεξιά για να βρεθεί στην επιθυμητή θέση



## Αποτέλεσμα

Με την χρήση ενός κωδικοποιητή θέσης και το πρόγραμμα αυτό μπορούμε να μιμηθούμε την ακρίβεια κίνησης που παρέχει ένας βηματικός κινητήρας, γλιτώνοντας την ανάγκη αγοράς βηματικών κινητήρων και των ανάλογων κυκλωμάτων οδήγησης τους.
## Τρόπος Χρήσης

Βεβαιωθείτε ότι είναι κατεβασμένη την βιβλιοθήκη για τον κωδικοποιητή θέσης.
https://github.com/PaulStoffregen/Encoder

Το πρόγραμμα είναι επέκτασης .ino και εκτελείτε χωρίς προβλήματα στο προγραμματιστικό περιβάλλον των Arduino. 

Μέσα στο πρόγραμμα, προτού φορτωθεί στον μικροελεγκτή, μπορεί να γίνει αλλαγή τυχών παραμέτρων όπως σε ποιες εξόδους/εισόδους είναι συνδεδεμένο τι και ποια είναι η επιτρεπτή ευαισθησία του κωδικοποιητή θέσης, αρχική τιμή είναι 4, δηλαδή ο κινητήρας μπορεί να κάνει λάθος μέχρι 4 βήματα και να μην διορθωθεί από το πρόγραμμα.

Όταν γίνουν οι αλλαγές, φορτώνετε το πρόγραμμα στον μικροελεγκτή.

Κάθε φορά που γίνονται αλλαγές, πρέπει να φορτωθεί το πρόγραμμα ξανά.

Ο ATmega328 μπορεί χωρίς προβλήματα να αναλάβει τον έλεγχο 2 κινητήρων, το πρόγραμμα περιλαμβάνει κωδικά μόνο για 1 κινητήρα όμως. Στην περίπτωση που χρειαστούνε 2 κινητήρες μπορεί να γίνει η χρήση του ίδιου κώδικα αντιγραφή-επικόλληση, με νέες εισόδους και εξόδους για τον νέο κινητήρα.
## Σχεδιάγραμμα τρέχοντος διάταξης
![Capture](https://user-images.githubusercontent.com/58628293/221648108-eab8bc9a-8479-485d-8ef2-36df91d9c9d2.PNG)
